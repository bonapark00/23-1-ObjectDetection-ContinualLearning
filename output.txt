2023-07-12 06:28:59,454 - INFO - Mode: rodeo, Selected seed: [0, 1, 2, 3], Current task: 1
rodeo - Seed 1 Task 1 (1/4) training:   0%|          | 0/4470 [00:00<?, ?it/s]
Epoch 0 offline training...:   0%|          | 0/363 [00:00<?, ?it/s][A
Epoch 0 offline training...:   0%|          | 1/363 [00:03<20:36,  3.42s/it][A
Epoch 0 offline training...:   1%|          | 2/363 [00:06<20:21,  3.38s/it][A
Epoch 0 offline training...:   1%|          | 3/363 [00:10<20:30,  3.42s/it][A
Epoch 0 offline training...:   1%|          | 4/363 [00:13<20:23,  3.41s/it][A
Epoch 0 offline training...:   1%|▏         | 5/363 [00:15<17:29,  2.93s/it][AEpoch 0 offline training...:   1%|▏         | 5/363 [00:17<21:13,  3.56s/it]
rodeo - Seed 1 Task 1 (1/4) training:   0%|          | 0/4470 [00:22<?, ?it/s]
Loading test dataset...
Target task ids:  [1]
Target task ids:  [2]
Target task ids:  [3]
Target task ids:  [4]
****************************************************************************************************
Start offline training of Rodeo method... current dataset: clad
Target task ids:  [1, 2]
Dataloader created
Epoch 0 Iter 0 loss: 1.9756555557250977
Traceback (most recent call last):
  File "main.py", line 208, in <module>
    main()
  File "main.py", line 133, in main
    method.online_step(data, samples_cnt, args.n_worker)
  File "/workspace/dongjae/clad_iblurry/i_blurry_clad/methods/rodeo.py", line 221, in online_step
    pretrained_model, images_list, targets_list, ssl_proposals_list = self.offline_pretrain(self.model, offline_dataloader, self.optimizer, epochs=1)
  File "/workspace/dongjae/clad_iblurry/i_blurry_clad/methods/rodeo.py", line 103, in offline_pretrain
    loss_dict = model(images, targets, ssl_proposals)
  File "/opt/conda/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/dongjae/clad_iblurry/i_blurry_clad/fast_rcnn/generalized_rcnn.py", line 116, in forward
    detections, detector_losses, proposals_logits = self.roi_heads(features, proposals, images.image_sizes, targets, bool(teacher_proposals), teacher_proposals)
  File "/opt/conda/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/dongjae/clad_iblurry/i_blurry_clad/fast_rcnn/roi_heads.py", line 784, in forward
    proposals, matched_idxs, labels, regression_targets = self.select_training_samples(proposals, targets) 
  File "/workspace/dongjae/clad_iblurry/i_blurry_clad/fast_rcnn/roi_heads.py", line 651, in select_training_samples
    sampled_inds = self.subsample(labels)
  File "/workspace/dongjae/clad_iblurry/i_blurry_clad/fast_rcnn/roi_heads.py", line 607, in subsample
    sampled_pos_inds, sampled_neg_inds = self.fg_bg_sampler(labels)
  File "/workspace/dongjae/clad_iblurry/i_blurry_clad/fast_rcnn/_utils.py", line 124, in __call__
    positive = torch.where(matched_idxs_per_image >= 1)[0]
KeyboardInterrupt
2023-07-12 06:30:43,726 - INFO - Mode: rodeo, Selected seed: [0, 1, 2, 3], Current task: 1
rodeo - Seed 1 Task 1 (1/4) training:   0%|          | 0/4470 [00:00<?, ?it/s]
Epoch 0 offline training...:   0%|          | 0/363 [00:00<?, ?it/s][A
Epoch 0 offline training...:   0%|          | 1/363 [00:03<19:36,  3.25s/it][A
Epoch 0 offline training...:   1%|          | 2/363 [00:06<19:49,  3.29s/it][A
Epoch 0 offline training...:   1%|          | 3/363 [00:08<16:45,  2.79s/it][A
Epoch 0 offline training...:   1%|          | 4/363 [00:11<17:25,  2.91s/it][A
Epoch 0 offline training...:   1%|▏         | 5/363 [00:14<17:33,  2.94s/it][A
Epoch 0 offline training...:   2%|▏         | 6/363 [00:17<17:57,  3.02s/it][A
Epoch 0 offline training...:   2%|▏         | 7/363 [00:21<18:32,  3.13s/it][A
Epoch 0 offline training...:   2%|▏         | 8/363 [00:24<19:16,  3.26s/it][A
Epoch 0 offline training...:   2%|▏         | 9/363 [00:27<18:56,  3.21s/it][A
Epoch 0 offline training...:   3%|▎         | 10/363 [00:30<18:07,  3.08s/it][A
Epoch 0 offline training...:   3%|▎         | 11/363 [00:33<17:55,  3.06s/it][A
Epoch 0 offline training...:   3%|▎         | 12/363 [00:36<18:21,  3.14s/it][A
Epoch 0 offline training...:   4%|▎         | 13/363 [00:39<18:15,  3.13s/it][A
Epoch 0 offline training...:   4%|▍         | 14/363 [00:43<18:44,  3.22s/it][A
Epoch 0 offline training...:   4%|▍         | 15/363 [00:46<18:20,  3.16s/it][A
Epoch 0 offline training...:   4%|▍         | 16/363 [00:49<17:43,  3.06s/it][A
Epoch 0 offline training...:   5%|▍         | 17/363 [00:52<17:43,  3.07s/it][A
Epoch 0 offline training...:   5%|▍         | 18/363 [00:53<15:03,  2.62s/it][A
Epoch 0 offline training...:   5%|▌         | 19/363 [00:57<16:15,  2.83s/it][A
Epoch 0 offline training...:   6%|▌         | 20/363 [01:00<17:11,  3.01s/it][AEpoch 0 offline training...:   6%|▌         | 20/363 [01:03<18:16,  3.20s/it]

Extracting backbone features...:   0%|          | 0/363 [00:00<?, ?it/s][A
Extracting backbone features...:   0%|          | 1/363 [00:01<11:03,  1.83s/it][A
Extracting backbone features...:   1%|          | 2/363 [00:03<11:04,  1.84s/it][A
Extracting backbone features...:   1%|          | 3/363 [00:05<10:24,  1.74s/it][A
Extracting backbone features...:   1%|          | 4/363 [00:06<10:18,  1.72s/it][A
Extracting backbone features...:   1%|▏         | 5/363 [00:08<09:58,  1.67s/it][A
Extracting backbone features...:   2%|▏         | 6/363 [00:10<10:02,  1.69s/it][A
Extracting backbone features...:   2%|▏         | 7/363 [00:11<10:17,  1.73s/it][A
Extracting backbone features...:   2%|▏         | 8/363 [00:13<10:20,  1.75s/it][A
Extracting backbone features...:   2%|▏         | 9/363 [00:15<10:43,  1.82s/it][A
Extracting backbone features...:   3%|▎         | 10/363 [00:17<10:52,  1.85s/it][A
Extracting backbone features...:   3%|▎         | 11/363 [00:19<10:40,  1.82s/it][A
Extracting backbone features...:   3%|▎         | 12/363 [00:21<10:18,  1.76s/it][A
Extracting backbone features...:   4%|▎         | 13/363 [00:22<10:21,  1.78s/it][A
Extracting backbone features...:   4%|▍         | 14/363 [00:24<10:22,  1.78s/it][A
Extracting backbone features...:   4%|▍         | 15/363 [00:26<10:24,  1.80s/it][A
Extracting backbone features...:   4%|▍         | 16/363 [00:28<10:18,  1.78s/it][A
Extracting backbone features...:   5%|▍         | 17/363 [00:30<10:27,  1.81s/it][A
Extracting backbone features...:   5%|▍         | 18/363 [00:31<10:12,  1.78s/it][A
Extracting backbone features...:   5%|▌         | 19/363 [00:33<10:12,  1.78s/it][A
Extracting backbone features...:   6%|▌         | 20/363 [00:35<10:34,  1.85s/it][AExtracting backbone features...:   6%|▌         | 20/363 [00:37<10:44,  1.88s/it]
Loading test dataset...
Target task ids:  [1]
Target task ids:  [2]
Target task ids:  [3]
Target task ids:  [4]
****************************************************************************************************
Start offline training of Rodeo method... current dataset: clad
Target task ids:  [1, 2]
Dataloader created
Epoch 0 Iter 0 loss: 1.9834167957305908
Offline training is done! successfully!
iter 0 feature extraction is done!
training PQ model with codebook size 32  nbits 8...
base data is loaded...
PQ model training is done!
reconstructing PQ model...
Offline training is done! It took 146.8487889766693 seconds
****************************************************************************************************
> /workspace/dongjae/clad_iblurry/i_blurry_clad/methods/rodeo.py(259)online_step()
-> self.memory.datalist.append(sample)
(Pdb) (Pdb) *** NameError: name 'datalist' is not defined
(Pdb) []
(Pdb) {'file_name': 'HT_TRAIN_000001_SH_000.jpg', 'img_info': {'file_name': 'HT_TRAIN_000001_SH_000.jpg', 'file_name_old': '/home/ma-user/work/data/Haitian/Haitian_0005_13_VP/images/Vehicle_Person_Shanghai008896_00035.jpg', 'id': 1, 'height': 1080, 'width': 1920, 'city': 'Shanghai', 'location': 'Citystreet', 'period': 'Daytime', 'weather': 'Clear', 'date': '20181015', 'time': '112030'}, 'objects': {'image_id': 1, 'category_id': [3, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 4, 3, 4, 5, 3, 4, 3, 3, 2, 2, 2, 2], 'bbox': [[65, 667, 174, 126], [418, 701, 30, 52], [399, 708, 27, 44], [347, 701, 32, 51], [330, 698, 28, 53], [283, 698, 30, 54], [249, 689, 41, 65], [459, 710, 20, 42], [474, 698, 76, 57], [575, 711, 63, 38], [623, 695, 66, 59], [662, 698, 50, 51], [695, 705, 66, 53], [737, 714, 44, 39], [765, 717, 34, 32], [763, 699, 35, 45], [803, 702, 28, 38], [796, 716, 57, 47], [830, 695, 43, 58], [864, 720, 24, 20], [892, 721, 45, 41], [952, 723, 10, 24], [1002, 733, 15, 37], [1073, 731, 40, 43], [1147, 708, 57, 95]], 'area': [21924, 1560, 1188, 1632, 1484, 1620, 2665, 840, 4332, 2394, 3894, 2550, 3498, 1716, 1088, 1575, 1064, 2679, 2494, 480, 1845, 240, 555, 1720, 5415], 'id': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25], 'truncated': [-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1], 'occluded': [-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, -1, -1, -1], 'iscrowd': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, 'task_num': 1, 'split': 'train'}
(Pdb) array([  0,   7,   8,   9,  12,  13,  16,  18,  22,  24,  28,  30,  31,
        32,  36,  37,  38,  42,  44,  45,  47,  50,  51,  53,  54,  55,
        60,  61,  62,  63,  68,  70,  73,  75,  76,  79,  80,  83,  89,
        93,  97,  98, 100, 102, 105, 106, 107, 108, 111, 116, 117, 120,
       123, 125, 126, 127, 130, 132, 136, 137, 139, 140, 145, 148, 149,
       150, 153, 155, 156, 158, 160, 164, 165, 169, 171, 173, 174, 177,
       182, 183, 188, 189, 190, 195, 197, 200, 201, 202, 203, 204, 205,
       208, 211, 216, 217, 218, 221, 225, 227, 228, 229, 233, 234, 236,
       242, 245, 246, 247, 249, 252, 254, 256, 259, 260, 264, 265, 268,
       269, 270, 271, 272, 274, 278, 280, 282, 283, 285, 287, 292, 295,
       296, 297, 298, 302, 303, 304, 307, 311, 313, 316, 317, 318, 321,
       322, 325, 327, 328, 329, 330, 331])
(Pdb) *** AttributeError
(Pdb) {'boxes': tensor([[  65.,  667.,  239.,  793.],
        [ 418.,  701.,  448.,  753.],
        [ 399.,  708.,  426.,  752.],
        [ 347.,  701.,  379.,  752.],
        [ 330.,  698.,  358.,  751.],
        [ 283.,  698.,  313.,  752.],
        [ 249.,  689.,  290.,  754.],
        [ 459.,  710.,  479.,  752.],
        [ 474.,  698.,  550.,  755.],
        [ 575.,  711.,  638.,  749.],
        [ 623.,  695.,  689.,  754.],
        [ 662.,  698.,  712.,  749.],
        [ 695.,  705.,  761.,  758.],
        [ 737.,  714.,  781.,  753.],
        [ 765.,  717.,  799.,  749.],
        [ 763.,  699.,  798.,  744.],
        [ 803.,  702.,  831.,  740.],
        [ 796.,  716.,  853.,  763.],
        [ 830.,  695.,  873.,  753.],
        [ 864.,  720.,  888.,  740.],
        [ 892.,  721.,  937.,  762.],
        [ 952.,  723.,  962.,  747.],
        [1002.,  733., 1017.,  770.],
        [1073.,  731., 1113.,  774.],
        [1147.,  708., 1204.,  803.]]), 'labels': tensor([3, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 4, 3, 4, 5, 3, 4, 3, 3, 2, 2, 2,
        2])}
(Pdb) 150
(Pdb) rodeo - Seed 1 Task 1 (1/4) training:   0%|          | 1/4470 [13:15<987:21:54, 795.37s/it]> /workspace/dongjae/clad_iblurry/i_blurry_clad/methods/rodeo.py(259)online_step()
-> self.memory.datalist.append(sample)
(Pdb) rodeo - Seed 1 Task 1 (1/4) training:   0%|          | 8/4470 [13:18<690:13:05, 556.88s/it]> /workspace/dongjae/clad_iblurry/i_blurry_clad/methods/rodeo.py(259)online_step()
-> self.memory.datalist.append(sample)
(Pdb) {'file_name': 'HT_TRAIN_000001_SH_000.jpg', 'img_info': {'file_name': 'HT_TRAIN_000001_SH_000.jpg', 'file_name_old': '/home/ma-user/work/data/Haitian/Haitian_0005_13_VP/images/Vehicle_Person_Shanghai008896_00035.jpg', 'id': 1, 'height': 1080, 'width': 1920, 'city': 'Shanghai', 'location': 'Citystreet', 'period': 'Daytime', 'weather': 'Clear', 'date': '20181015', 'time': '112030'}, 'objects': {'image_id': 1, 'category_id': [3, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 4, 3, 4, 5, 3, 4, 3, 3, 2, 2, 2, 2], 'bbox': [[65, 667, 174, 126], [418, 701, 30, 52], [399, 708, 27, 44], [347, 701, 32, 51], [330, 698, 28, 53], [283, 698, 30, 54], [249, 689, 41, 65], [459, 710, 20, 42], [474, 698, 76, 57], [575, 711, 63, 38], [623, 695, 66, 59], [662, 698, 50, 51], [695, 705, 66, 53], [737, 714, 44, 39], [765, 717, 34, 32], [763, 699, 35, 45], [803, 702, 28, 38], [796, 716, 57, 47], [830, 695, 43, 58], [864, 720, 24, 20], [892, 721, 45, 41], [952, 723, 10, 24], [1002, 733, 15, 37], [1073, 731, 40, 43], [1147, 708, 57, 95]], 'area': [21924, 1560, 1188, 1632, 1484, 1620, 2665, 840, 4332, 2394, 3894, 2550, 3498, 1716, 1088, 1575, 1064, 2679, 2494, 480, 1845, 240, 555, 1720, 5415], 'id': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25], 'truncated': [-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1], 'occluded': [-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0, -1, 0, 0, 0, 0, -1, -1, 0, -1, -1, -1, -1, -1], 'iscrowd': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, 'task_num': 1, 'split': 'train'}
(Pdb) *** IndexError: list index out of range
(Pdb) rodeo - Seed 1 Task 1 (1/4) training:   0%|          | 9/4470 [14:58<520:28:20, 420.02s/it]> /workspace/dongjae/clad_iblurry/i_blurry_clad/methods/rodeo.py(259)online_step()
-> self.memory.datalist.append(sample)
(Pdb) rodeo - Seed 1 Task 1 (1/4) training:   0%|          | 10/4470 [15:00<364:46:32, 294.44s/it]> /workspace/dongjae/clad_iblurry/i_blurry_clad/methods/rodeo.py(259)online_step()
-> self.memory.datalist.append(sample)
(Pdb) {'file_name': 'HT_TRAIN_000009_SH_000.jpg', 'img_info': {'file_name': 'HT_TRAIN_000009_SH_000.jpg', 'file_name_old': '/home/ma-user/work/data/Haitian/Haitian_0005_11_2_VP/images/Vehicle_Person_Shanghai008466_00017.jpg', 'id': 9, 'height': 1080, 'width': 1920, 'city': 'Shanghai', 'location': 'Citystreet', 'period': 'Daytime', 'weather': 'Clear', 'date': '20181015', 'time': '102545'}, 'objects': {'image_id': 9, 'category_id': [4, 4, 4, 3], 'bbox': [[0, 225, 527, 659], [412, 521, 296, 264], [666, 593, 111, 151], [695, 579, 365, 379]], 'area': [347293, 78144, 16761, 138335], 'id': [72, 73, 74, 75], 'truncated': [-1, -1, -1, -1], 'occluded': [-1, -1, 0, -1], 'iscrowd': [0, 0, 0, 0]}, 'task_num': 1, 'split': 'train'}
(Pdb) {'boxes': tensor([[   0.,  225.,  527.,  884.],
        [ 412.,  521.,  708.,  785.],
        [ 666.,  593.,  777.,  744.],
        [ 695.,  579., 1060.,  958.]]), 'labels': tensor([4, 4, 4, 3])}
(Pdb) *** KeyError: 'objects'
(Pdb) *** SyntaxError: EOL while scanning string literal
(Pdb) [[0, 225, 527, 659], [412, 521, 296, 264], [666, 593, 111, 151], [695, 579, 365, 379]]
(Pdb) rodeo - Seed 1 Task 1 (1/4) training:   0%|          | 12/4470 [18:02<111:43:42, 90.22s/it] 
Traceback (most recent call last):
  File "main.py", line 208, in <module>
    main()
  File "main.py", line 133, in main
    method.online_step(data, samples_cnt, args.n_worker)
  File "/workspace/dongjae/clad_iblurry/i_blurry_clad/methods/rodeo.py", line 259, in online_step
    self.memory.datalist.append(sample)
  File "/workspace/dongjae/clad_iblurry/i_blurry_clad/methods/rodeo.py", line 259, in online_step
    self.memory.datalist.append(sample)
  File "/opt/conda/lib/python3.7/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/opt/conda/lib/python3.7/bdb.py", line 113, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit
